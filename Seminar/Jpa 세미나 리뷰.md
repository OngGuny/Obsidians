왜 jpa를 주제로? 

질문:
여러 엔티티 매니저가 있으면 영속성 컨텍스트는 몇개가 되는거?
일단 각자 만든다.  각자 연결을 갖고있으니. 
<- 커넥션에 대한 이해가 부족해서 이 질문을 한거다. 

jpa 와 spring jpa 는 다르다. 
페이지네이션의경우도 spring jpa 에서 지원해주는것. 

물리적 db 와 메모리에 있는 객체를 매핑해주는 기술. 
db를 몰라도 jpql 을사용해서 데이터를 조작할수있다. (잘만들었다면)

들고올때는 네이티브쿼리를 쓰는게 유리. 프로젝션과 함께. 
많은데이터가 오가니까. 

jpa 의 패러다임은 동일성과 동등성을 둘다 만족해야한다는 것. 그래서 구현을 다 해주는것. 

매니저팩토리 -> 멀티스레드 지원 
엔티티매니저 -> 매니저팩토리가만들어주는것. 싱글스레드, 트랜잭션?? 
재사용 안됨. 


영속성컨텍스트 = 1차 캐시. 
-> 엔티티 매니저가 로드하는 것, 
엔티티 매니저가 생성한 영속성 컨텍스트. 

*여러 엔티티 매니저가 있으면 영속성 컨텍스트는 몇개가 되는거?*

엔티티가 같은상태로유지되는 환경? 


새로생긴 엔티티를 persist 하면 영속성 컨텍스트로 올라간다.  
flush 를 통해서 db 와 데이터를 동기화.  

1차 캐시 : 
io 작업의 오버헤드를 줄이기 위해 한번에 작업하려고 작업들을 모아두는곳. 
준영속 상태의 엔티티에 대한 작업을 모으고. 플러시할때 한번에 실행.
그런데 내가 설정한 작업의순서대로 작업이 실행되지는 않는다. 

- 쓰기 지연 : 작업할 쿼리들을 모아둠...
- 나머지내용은 요약 다음에. 



더티체킹 
엔티티를 영속성 컨텍스트에 저장할때, 최초상태를 저장. 

플러시
jpql 을 사용하면 auto flush가도니다.

==> 조회를 위한 쿼리만 nativequery를써야하는거고, update를 위해서는 native쓰면안된다.  데이터변경을 jpa 가 관리하게 위임하니까.  네이티브쿼리는 이 위임을 취소하는것. 


